<?xml version="1.0" encoding="UTF-8"?>
<modification>
        <id>Search model in orderlist</id>
        <version>1.0</version>
        <vqmver>2.0</vqmver>
        <author>eleo (https://opencartforum.com/profile/702552-eleo/)</author>	
        <file name="admin/controller/sale/order.php">
				<operation>
					<search position="before" index="4"><![CDATA[
		if (isset($this->request->get['filter_date_added'])) {
						]]></search>
						<add><![CDATA[
		if (isset($this->request->get['filter_model'])) {
			$filter_model = $this->request->get['filter_model'];
		} else {
			$filter_model = null;
		}
						]]>
					</add>
				</operation>
				<operation>
					<search position="before" index="5"><![CDATA[
		if (isset($this->request->get['filter_date_added'])) {
						]]></search>
						<add><![CDATA[
		if (isset($this->request->get['filter_model'])) {
			$url .= '&filter_model=' . $this->request->get['filter_model'];
		}
						]]>
					</add>
				</operation>
				<operation>
					<search position="before"><![CDATA[
			'filter_date_added'      => $filter_date_added,
						]]></search>
						<add><![CDATA[
			'filter_model'           => $filter_model,
						]]>
					</add>
				</operation>
				<operation>
					<search position="before" index="6"><![CDATA[
		if (isset($this->request->get['filter_date_added'])) {
						]]></search>
						<add><![CDATA[
		if (isset($this->request->get['filter_model'])) {
			$url .= '&filter_model=' . $this->request->get['filter_model'];
		}
						]]>
					</add>
				</operation>
				<operation>
					<search position="before" index="7"><![CDATA[
		if (isset($this->request->get['filter_date_added'])) {
						]]></search>
						<add><![CDATA[
		if (isset($this->request->get['filter_model'])) {
			$url .= '&filter_model=' . $this->request->get['filter_model'];
		}
						]]>
					</add>
				</operation>
				<operation>
					<search position="before"><![CDATA[
		$this->data['filter_date_added'] = $filter_date_added;
						]]></search>
						<add><![CDATA[
		$this->data['filter_model'] = $filter_model;
						]]>
					</add>
				</operation>
		</file>
        <file name="admin/model/sale/order.php">
				<operation>
					<search position="before" index="1"><![CDATA[
		if (isset($data['filter_order_status_id']) && !is_null($data['filter_order_status_id'])) {
						]]></search>
						<add><![CDATA[
		if (!empty($data['filter_model'])) {
			$sql .= " INNER JOIN " . DB_PREFIX . "order_product AS orpro ON o.order_id=orpro.order_id";
		}
						]]>
					</add>
				</operation>
				<operation>
					<search position="before" index="1"><![CDATA[
		if (!empty($data['filter_order_id'])) {
						]]></search>
						<add><![CDATA[
		if (!empty($data['filter_model'])) {
			$sql .= " AND model = '" . $data['filter_model'] . "'";
		}
						]]>
					</add>
				</operation>
		</file>
        <file name="admin/view/template/sale/order_list.tpl">
				<operation>
					<search position="after"><![CDATA[
              <td align="right"><input type="text" name="filter_total" value="<?php echo $filter_total; ?>" size="4" style="text-align: right;" /></td>
						]]></search>
						<add><![CDATA[
              <td align="right"><input type="text" placeholder="model" name="filter_model" value="<?php echo $filter_model; ?>" size="8" style="text-align: right;" /></td>
						]]>
					</add>
				</operation>
				<operation>
					<search position="before"><![CDATA[
              <td class="left"><?php if ($sort == 'o.date_added') { ?>
						]]></search>
						<add><![CDATA[
              <td class="right">Поиск по модели</td>
						]]>
					</add>
				</operation>
				<operation>
					<search position="before"><![CDATA[
              <td class="left"><?php echo $order['date_added']; ?></td>
						]]></search>
						<add><![CDATA[
              <td class="right"><?php echo $filter_model; ?></td>
						]]>
					</add>
				</operation>
				<operation>
					<search position="before"><![CDATA[
	var filter_date_added = $('input[name=\'filter_date_added\']').attr('value');
						]]></search>
						<add><![CDATA[
	var filter_model = $('input[name=\'filter_model\']').attr('value');

	if (filter_model) {
		url += '&filter_model=' + encodeURIComponent(filter_model);
	}
						]]>
					</add>
				</operation>
		</file>
</modification>